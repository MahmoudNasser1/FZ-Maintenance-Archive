# دليل المكونات الرئيسية لنظام أرشيف الصيانة

## نظرة عامة
هذا الدليل يوضح المكونات الرئيسية في نظام أرشيف الصيانة، بما في ذلك هيكلها ووظائفها وكيفية استخدامها.

## الواجهة الأمامية (Frontend)

### 1. مكونات إدارة الحالات

#### CasesTable
مكون عرض جدول الحالات بقدرات الفرز والترتيب والتصفية.

- **الموقع**: `frontend/src/components/cases/CasesTable.tsx`
- **الوظائف الرئيسية**:
  - عرض قائمة الحالات بتنسيق جدولي
  - دعم فرز البيانات حسب أي عمود
  - دعم ترقيم الصفحات
  - إظهار حالة التحميل
  - التفاعل مع المستخدم (فتح تفاصيل الحالة، تغيير الحالة)

#### CaseDetails
صفحة تعرض تفاصيل حالة صيانة محددة مع علامات تبويب للملاحظات والمرفقات وسجل الأنشطة.

- **الموقع**: `frontend/src/pages/cases/CaseDetails.tsx`
- **الوظائف الرئيسية**:
  - عرض معلومات أساسية عن الحالة
  - عرض تاريخ سير العمل والتغييرات
  - إدارة الملاحظات (عرض، إضافة، تعديل)
  - إدارة المرفقات (عرض، إضافة، حذف)
  - إدارة سجل العمل (عرض، إضافة)
  - تتبع الأنشطة على الحالة

#### CasesList
صفحة قائمة الحالات مع خيارات متقدمة للتصفية والبحث.

- **الموقع**: `frontend/src/pages/cases/CasesList.tsx`
- **الوظائف الرئيسية**:
  - عرض قائمة الحالات قابلة للتصفية
  - فلاتر متقدمة (حسب الحالة، التاريخ، نوع الجهاز، إلخ)
  - بحث سريع
  - إضافة حالة جديدة
  - تصدير النتائج

### 2. مكونات لوحة التحكم

#### CaseStatistics
مكون يعرض إحصائيات حالات الصيانة، مثل العدد الإجمالي، الحالات المعلقة والمكتملة.

- **الموقع**: `frontend/src/components/dashboard/CaseStatistics.tsx`
- **الوظائف الرئيسية**:
  - عرض إحصائيات الحالات في بطاقات مرئية
  - رسم بياني دائري لتوزيع الحالات
  - إمكانية تحديث البيانات

#### RecentActivities
مكون يعرض آخر النشاطات على حالات الصيانة.

- **الموقع**: `frontend/src/components/dashboard/RecentActivities.tsx`
- **الوظائف الرئيسية**:
  - عرض قائمة بآخر النشاطات
  - تصنيف الأنشطة حسب النوع
  - روابط سريعة للحالات المرتبطة

#### Dashboard
صفحة لوحة التحكم الرئيسية التي تجمع الإحصائيات والأنشطة الحديثة.

- **الموقع**: `frontend/src/pages/Dashboard.tsx`
- **الوظائف الرئيسية**:
  - تجميع وعرض مكونات لوحة التحكم
  - توفير نظرة عامة على الحالات والأداء

### 3. مكونات التقارير

#### ReportCard
إطار قياسي لعرض التقارير والرسومات البيانية.

- **الموقع**: `frontend/src/components/reports/ReportCard.tsx`
- **الوظائف الرئيسية**:
  - تقديم واجهة موحدة للتقارير
  - خيارات لتحديث وتصدير التقارير
  - إظهار حالة التحميل

#### StatusDistributionChart
مكون رسم بياني دائري لعرض توزيع حالات الصيانة حسب الحالة.

- **الموقع**: `frontend/src/components/reports/StatusDistributionChart.tsx`
- **الوظائف الرئيسية**:
  - عرض نسب حالات الصيانة بيانيًا
  - عرض تفاصيل العدد والنسبة المئوية
  - تصميم تفاعلي سهل القراءة

#### TimelineChart
مكون رسم بياني خطي لعرض بيانات الحالات على مدى فترة زمنية.

- **الموقع**: `frontend/src/components/reports/TimelineChart.tsx`
- **الوظائف الرئيسية**:
  - عرض اتجاهات الحالات عبر الزمن
  - دعم عرض بيانات متعددة (حالات جديدة، مكتملة، معلقة)
  - خيارات للتخصيص والتحكم في العرض

#### Reports
صفحة التقارير والإحصائيات المتقدمة.

- **الموقع**: `frontend/src/pages/Reports.tsx`
- **الوظائف الرئيسية**:
  - تجميع وعرض تقارير متنوعة
  - خيارات لتخصيص نطاق البيانات
  - عرض مؤشرات الأداء الرئيسية

## الواجهة الخلفية (Backend)

### 1. نموذج البيانات

#### Cases
نموذج لتخزين معلومات حالات الصيانة.

- **الموقع**: `backend/app/models/case.py`
- **الحقول الرئيسية**:
  - معرف الحالة (id)
  - عنوان الحالة (title)
  - وصف (description)
  - حالة الصيانة (status)
  - نوع الجهاز (device_type)
  - معرف العميل (customer_id)
  - معرف الفني المسؤول (technician_id)
  - تاريخ الإنشاء (created_at)
  - تاريخ التحديث (updated_at)

#### Notes
نموذج لتخزين ملاحظات الحالات.

- **الموقع**: `backend/app/models/note.py`
- **العلاقات**:
  - علاقة مع جدول الحالات
  - علاقة مع جدول المستخدمين (الكاتب)

#### Attachments
نموذج لتخزين مرفقات الحالات.

- **الموقع**: `backend/app/models/attachment.py`
- **العلاقات**:
  - علاقة مع جدول الحالات
  - علاقة مع جدول المستخدمين (الرافع)

#### Activities
نموذج لتخزين سجل الأنشطة على الحالات.

- **الموقع**: `backend/app/models/activity.py`
- **العلاقات**:
  - علاقة مع جدول الحالات
  - علاقة مع جدول المستخدمين (الفاعل)

### 2. واجهات برمجة التطبيقات (APIs)

#### Cases API
توفر وظائف لإدارة حالات الصيانة.

- **الموقع**: `backend/app/api/endpoints/cases.py`
- **النقاط النهائية**:
  - `GET /cases/`: قراءة قائمة الحالات
  - `POST /cases/`: إنشاء حالة جديدة
  - `GET /cases/{case_id}`: قراءة تفاصيل حالة محددة
  - `PUT /cases/{case_id}`: تحديث حالة محددة
  - `DELETE /cases/{case_id}`: حذف حالة محددة

#### Notes API
توفر وظائف لإدارة ملاحظات الحالات.

- **الموقع**: `backend/app/api/endpoints/notes.py`
- **النقاط النهائية**:
  - `GET /cases/{case_id}/notes/`: قراءة ملاحظات حالة محددة
  - `POST /cases/{case_id}/notes/`: إضافة ملاحظة جديدة
  - `PUT /notes/{note_id}`: تحديث ملاحظة
  - `DELETE /notes/{note_id}`: حذف ملاحظة

#### Attachments API
توفر وظائف لإدارة مرفقات الحالات.

- **الموقع**: `backend/app/api/endpoints/attachments.py`
- **النقاط النهائية**:
  - `GET /cases/{case_id}/attachments/`: قراءة مرفقات حالة محددة
  - `POST /cases/{case_id}/attachments/`: إضافة مرفق جديد
  - `GET /attachments/{attachment_id}`: تحميل مرفق
  - `DELETE /attachments/{attachment_id}`: حذف مرفق

#### Reports API
توفر وظائف لاستخراج التقارير والإحصائيات.

- **الموقع**: `backend/app/api/endpoints/reports.py`
- **النقاط النهائية**:
  - `GET /reports/statistics/`: إحصائيات عامة
  - `GET /reports/timeline/`: بيانات الاتجاهات الزمنية
  - `GET /reports/technicians/`: بيانات أداء الفنيين
  - `GET /reports/devices/`: بيانات إصلاح الأجهزة

## مخطط تفاعل المكونات

```
+------------------+        +-------------------+
| واجهة المستخدم  |  <---> | خدمات الواجهة    |
| (React)          |        | الأمامية         |
+------------------+        +-------------------+
         |                           |
         |                           |
         v                           v
+------------------+        +-------------------+
| واجهة برمجة     |  <---> | مستودعات البيانات|
| التطبيقات      |        |                   |
+------------------+        +-------------------+
         |                           |
         |                           |
         v                           v
+------------------+        +-------------------+
| نماذج البيانات  |  <---> | قاعدة البيانات   |
|                  |        | (PostgreSQL)      |
+------------------+        +-------------------+
```

## مرجع سريع للتسميات والأعراف

### تسمية المكونات
- تستخدم تسمية PascalCase للمكونات، مثل: `CasesTable`، `CaseDetails`
- تستخدم تسمية camelCase للمتغيرات والخصائص، مثل: `caseId`، `isLoading`
- تستخدم تسمية UPPER_SNAKE_CASE للثوابت، مثل: `API_BASE_URL`

### ملاحظات حول التطوير
- جميع مكونات الواجهة الأمامية عبارة عن دوال React حديثة
- يتم استخدام TypeScript للحصول على أمان النوع
- تُستخدم Tailwind CSS للتصميم
- يعتمد النظام على العديد من الجوانب المتقدمة في React مثل Hooks والواجهات التي تحفظ الحالة

## توصيات للمطورين
- عند إضافة مكون جديد، يرجى اتباع نفس تنظيم المجلدات وأعراف التسمية
- تأكد من دعم التصميم للاستجابة والتوافق مع RTL
- قم بتحديث هذا الدليل عند إضافة مكونات رئيسية جديدة
